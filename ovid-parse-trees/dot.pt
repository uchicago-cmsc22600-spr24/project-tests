(Prog (TypeDcl Vec2 () (Con V2 (ConTy Int) (ConTy Int))) (TypeDcl Vec3 () (Con V3 (ConTy Int) (ConTy Int) (ConTy Int)))
      (OverloadDcl dot (OvldTy (a) (FunTy (VarTy a) (FunTy (VarTy a) (ConTy Int)))))
      (FunBind v2dot ((VarPat u) (VarPat v))
               (CaseExp (VarExp u)
                        ((CaseRule (ConPat V2 (VarPat x1) (VarPat y1))
                                   (CaseExp (VarExp v)
                                            ((CaseRule (ConPat V2 (VarPat x2) (VarPat y2))
                                                       (BinExp (BinExp (VarExp x1) * (VarExp x2)) +
                                                               (BinExp (VarExp y1) * (VarExp y2))))))))))
      (InstanceDcl dot (OvldTy () (FunTy (ConTy Vec2) (FunTy (ConTy Vec2) (ConTy Int)))) v2dot)
      (FunBind v3dot ((VarPat u) (VarPat v))
               (CaseExp (VarExp u)
                        ((CaseRule (ConPat V3 (VarPat x1) (VarPat y1) (VarPat z1))
                                   (CaseExp (VarExp v)
                                            ((CaseRule (ConPat V3 (VarPat x2) (VarPat y2) (VarPat z2))
                                                       (BinExp (BinExp (BinExp (VarExp x1) * (VarExp x2)) +
                                                                       (BinExp (VarExp y1) * (VarExp y2))) +
                                                               (BinExp (VarExp z1) * (VarExp z2))))))))))
      (InstanceDcl dot (OvldTy () (FunTy (ConTy Vec3) (FunTy (ConTy Vec3) (ConTy Int)))) v3dot)
      (FunBind length2 ((VarPat u)) (AppExp (AppExp (VarExp dot) (VarExp u)) (VarExp u)))
      (DoExpBind (CaseExp (VarExp arguments)
                          ((CaseRule (ConPat Cons (VarPat x) (VarPat args))
                                     (CaseExp (VarExp args)
                                              ((CaseRule (ConPat Cons (VarPat y) (VarPat args))
                                                         (CaseExp (VarExp args)
                                                                  ((CaseRule (ConPat Nil)
                                                                             (BindExp (DoExpBind (AppExp (VarExp print)
                                                                                                         (StrExp "length^2\x20;=\x20;")))
                                                                                      (BindExp (DoExpBind (AppExp (VarExp print)
                                                                                                                  (AppExp (VarExp toString)
                                                                                                                       (AppExp (VarExp length2)
                                                                                                                       (AppExp (AppExp (ConExp V2)
                                                                                                                       (VarExp x))
                                                                                                                       (VarExp y))))))
                                                                                               (AppExp (VarExp print)
                                                                                                       (StrExp "\n"))))) (CaseRule (ConPat Cons
                                                                                                                       (VarPat z)
                                                                                                                       (VarPat args))
                                                                                                                       (BindExp (DoExpBind (AppExp (VarExp print)
                                                                                                                       (StrExp "length^2\x20;=\x20;")))
                                                                                                                       (BindExp (DoExpBind (AppExp (VarExp print)
                                                                                                                       (AppExp (VarExp toString)
                                                                                                                       (AppExp (VarExp length2)
                                                                                                                       (AppExp (AppExp (AppExp (ConExp V3)
                                                                                                                       (VarExp x))
                                                                                                                       (VarExp y))
                                                                                                                       (VarExp z))))))
                                                                                                                       (AppExp (VarExp print)
                                                                                                                       (StrExp "\n")))))))) (CaseRule (ConPat Nil)
                                                                                                                       (AppExp (VarExp fail)
                                                                                                                       (StrExp "missing\x20;arguments\n")))))) (CaseRule (ConPat Nil)
                                                                                                                       (AppExp (VarExp fail)
                                                                                                                       (StrExp "missing\x20;arguments\n")))))))
