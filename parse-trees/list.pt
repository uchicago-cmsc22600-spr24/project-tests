(Prog (FunBind intToString ((VarPat i))
               (IfExp (BinExp (VarExp i) < (IntExp 0))
                      (AppExp (VarExp concat)
                              (TupleExp (StrExp "-") (AppExp (VarExp intToString) (UnExp unary - (VarExp i)))))
                      (IfExp (BinExp (VarExp i) == (IntExp 0)) (StrExp "0")
                             (IfExp (BinExp (VarExp i) == (IntExp 1)) (StrExp "1")
                                    (IfExp (BinExp (VarExp i) == (IntExp 2)) (StrExp "2")
                                           (IfExp (BinExp (VarExp i) == (IntExp 3)) (StrExp "3")
                                                  (IfExp (BinExp (VarExp i) == (IntExp 4)) (StrExp "4")
                                                         (IfExp (BinExp (VarExp i) == (IntExp 5)) (StrExp "5")
                                                                (IfExp (BinExp (VarExp i) == (IntExp 6)) (StrExp "6")
                                                                       (IfExp (BinExp (VarExp i) == (IntExp 7))
                                                                              (StrExp "7")
                                                                              (IfExp (BinExp (VarExp i) == (IntExp 8))
                                                                                     (StrExp "8")
                                                                                     (IfExp (BinExp (VarExp i) ==
                                                                                                    (IntExp 9))
                                                                                            (StrExp "9")
                                                                                            (AppExp (VarExp concat)
                                                                                                    (TupleExp (AppExp (VarExp intToString)
                                                                                                                      (BinExp (VarExp i)
                                                                                                                       /
                                                                                                                       (IntExp 10)))
                                                                                                              (AppExp (VarExp intToString)
                                                                                                                      (BinExp (VarExp i)
                                                                                                                       %
                                                                                                                       (IntExp 10)))))))))))))))))
      (FunBind foldl ((VarPat f) (VarPat b) (VarPat l))
               (CaseExp (VarExp l)
                        ((CaseRule (ConPat Nil) (VarExp b)) (CaseRule (ConPat Cons (VarPat hd) (VarPat tl))
                                                                      (AppExp (AppExp (AppExp (VarExp foldl)
                                                                                              (VarExp f))
                                                                                      (AppExp (AppExp (VarExp f)
                                                                                                      (VarExp hd))
                                                                                              (VarExp b))) (VarExp tl))))))
      (FunBind rev ((VarPat xs))
               (BindExp (FunBind cons ((VarPat hd) (VarPat tl))
                                 (AppExp (AppExp (ConExp Cons) (VarExp hd)) (VarExp tl)))
                        (AppExp (AppExp (AppExp (VarExp foldl) (VarExp cons)) (ConExp Nil)) (VarExp xs))))
      (FunBind tabulate ((TuplePat (VarPat n) (VarPat f)))
               (BindExp (FunBind loop ((TuplePat (VarPat i) (VarPat acc)))
                                 (IfExp (BinExp (VarExp i) <= (VarExp n))
                                        (AppExp (VarExp loop)
                                                (TupleExp (BinExp (VarExp i) + (IntExp 1))
                                                          (AppExp (AppExp (ConExp Cons) (AppExp (VarExp f) (VarExp i)))
                                                                  (VarExp acc)))) (AppExp (VarExp rev) (VarExp acc))))
                        (IfExp (BinExp (VarExp n) < (IntExp 0))
                               (AppExp (VarExp fail) (StrExp "tabulate:\x20;n\x20;<\x20;0"))
                               (AppExp (VarExp loop) (TupleExp (IntExp 0) (ConExp Nil))))))
      (ValBind (VarPat n) (IntExp 4999))
      (ValBind (VarPat sum_n)
               (BindExp (FunBind f ((VarPat x) (VarPat y)) (BinExp (VarExp x) + (VarExp y)))
                        (BindExp (FunBind g ((VarPat i)) (VarExp i))
                                 (AppExp (AppExp (AppExp (VarExp foldl) (VarExp f)) (IntExp 0))
                                         (AppExp (VarExp tabulate) (TupleExp (VarExp n) (VarExp g)))))))
      (DoExpBind (AppExp (VarExp print) (StrExp "foldl\x20;\n")))
      (DoExpBind (AppExp (VarExp print)
                         (StrExp "\x20;\x20;\x20;\x20;\x20;\x20;(fn\x20;x\x20;y\x20;=>\x20;x\x20;+\x20;y)\n")))
      (DoExpBind (AppExp (VarExp print) (StrExp "\x20;\x20;\x20;\x20;\x20;\x20;0\x20;(tabulate\x20;(")))
      (DoExpBind (AppExp (VarExp print) (AppExp (VarExp intToString) (VarExp n))))
      (DoExpBind (AppExp (VarExp print) (StrExp ",\x20;(fn\x20;i\x20;=>\x20;i)))\x20;=\x20;")))
      (DoExpBind (AppExp (VarExp print) (AppExp (VarExp intToString) (VarExp sum_n))))
      (DoExpBind (AppExp (VarExp print) (StrExp "\n"))))
